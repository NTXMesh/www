<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Coverage Map</title>
    <meta name="description" content="Learn about NTXMesh Coverage">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RGYHDR5D6D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RGYHDR5D6D');
    </script>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="https://matcha.mizu.sh/matcha.css">
    <link rel="stylesheet" href="../styles.css?v=2">
</head>
<body>
<header>
    <a href="/"><img src="../images/NTX-Mesh-Logo.svg" class="logo" alt="Logo for NTX Mesh" title="NTX Mesh" width="500" height="121"></a>
</header>

<main>
    <!-- Your nav/menu here -->

    <h1>Modem Preset Map by County</h1>
    <div id="modem_preset_map" style="text-align: center;">
        <a href="../images/Modem_Presets_by_County_Map.png" target="_blank">
    <img src="../images/Modem_Presets_by_County_Map.png"
         alt="Modem Preset Map by County"
         title="Modem Preset Map by County"
         style="max-width: 100%; height: auto;">
</a>
    </div>

    <br>

    <h2>Coverage Map</h2>
    <div id="map" style="height: 600px; width: 100%;"></div>
</main>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var map = L.map('map').setView([30.2672, -97.7431], 10);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    fetch('NTX-mesh-rangetests.csv')
        .then(response => response.text())
        .then(csv => {
            var heatmapData = [];
            var lines = csv.split('\n');
            lines.forEach(function(line, i) {
                if (i !== 0) {
                    var columns = line.split(',');
                    if (columns.length >= 3) {
                        var lat = parseFloat(columns[0]);
                        var lng = parseFloat(columns[1]);
                        var intensity = parseFloat(columns[2]);
                        if (!isNaN(lat) && !isNaN(lng)) {
                            heatmapData.push([lat, lng, intensity]);
                        }
                    }
                }
            });
            L.heatLayer(heatmapData, {
                radius: 25,
                blur: 30,
                max: 200,
                maxZoom: 13,
                minOpacity: 0.3
            }).addTo(map);
        })
        .catch(err => console.error('Error loading the CSV file:', err));
});
</script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    document.querySelector("header").classList.add("loaded");
});
</script>

</body>
</html>